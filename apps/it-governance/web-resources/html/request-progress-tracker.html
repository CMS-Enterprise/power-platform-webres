<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Process Progress Tracker</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        overflow-x: auto;
        overflow-y: hidden;
      }

      .progress-container {
        min-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
      }

      .progress-header {
        text-align: center;
        margin-bottom: 40px;
      }

      .progress-header h2 {
        color: #2c3e50;
        font-size: 24px;
        margin-bottom: 10px;
      }

      .current-status {
        color: #0078d4;
        font-size: 16px;
        font-weight: 500;
      }

      .progress-track {
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin: 60px 20px 30px;
      }

      .progress-line {
        position: absolute;
        top: 20px;
        left: 0;
        right: 0;
        height: 4px;
        background: #e0e0e0;
        z-index: 1;
      }

      .progress-line-fill {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        background: linear-gradient(90deg, #0078d4, #106ebe);
        transition: width 0.5s ease;
        z-index: 2;
      }

      .step {
        position: relative;
        z-index: 3;
        display: flex;
        flex-direction: column;
        align-items: center;
        flex: 1;
        min-width: 100px;
        max-width: 120px;
      }

      .step-number {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: white;
        border: 3px solid #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 16px;
        color: #666;
        transition: all 0.3s ease;
        margin-bottom: 10px;
      }

      .step.completed .step-number {
        background: #0078d4;
        border-color: #0078d4;
        color: white;
        transform: scale(1.1);
      }

      .step.current .step-number {
        background: white;
        border-color: #0078d4;
        color: #0078d4;
        border-width: 4px;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(0, 120, 212, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(0, 120, 212, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(0, 120, 212, 0);
        }
      }

      .step-label {
        text-align: center;
        font-size: 12px;
        color: #666;
        max-width: 100px;
        line-height: 1.3;
      }

      .step.completed .step-label {
        color: #0078d4;
        font-weight: 500;
      }

      .step.current .step-label {
        color: #0078d4;
        font-weight: 600;
      }

      .legend {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 40px;
        padding: 20px;
        border-top: 1px solid #e0e0e0;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #666;
      }

      .legend-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        border: 3px solid #e0e0e0;
      }

      .legend-icon.completed {
        background: #0078d4;
        border-color: #0078d4;
      }

      .legend-icon.current {
        border-color: #0078d4;
        border-width: 4px;
      }

      /* Responsive adjustments */
      @media (max-width: 1200px) {
        .step-label {
          font-size: 11px;
        }
      }
    </style>
  </head>
  <body>
    <div class="progress-container">
      <div class="progress-header">
        <h2>Request Progress</h2>
        <div class="current-status" id="currentStatusText">Loading...</div>
      </div>

      <div class="progress-track">
        <div class="progress-line">
          <div class="progress-line-fill" id="progressFill"></div>
        </div>
        <!-- Steps will be generated by JavaScript -->
      </div>

      <div class="legend">
        <div class="legend-item">
          <div class="legend-icon completed"></div>
          <span>Completed</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon current"></div>
          <span>Current Step</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon"></div>
          <span>Pending</span>
        </div>
      </div>
    </div>

    <script>
      // Process steps configuration
      const processSteps = [
        { label: "Draft", status: 971270006 },
        { label: "Intake Request Review", status: 971270000 },
        { label: "Draft Business Case", status: 971270001 },
        { label: "Schedule GRT Meeting", status: 100000001 },
        { label: "GRT Meeting", status: 971270002 },
        { label: "Final Business Case", status: 971270003 },
        { label: "Schedule GRB Review", status: 100000002 },
        { label: "GRB Review", status: 971270004 },
        { label: "Decision", status: 971270005 },
        { label: "Awaiting Decision", status: 971270007 },
        { label: "Issue LCID", status: 971270008 },
        { label: "Finished", status: 971270009 },
      ];

      function getQueryParameter(name) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(name);
      }

      function renderProgress(currentStatus) {
        const trackElement = document.querySelector(".progress-track");
        const existingSteps = trackElement.querySelectorAll(".step");
        existingSteps.forEach((step) => step.remove());

        let currentStepIndex = processSteps.findIndex(
          (step) => step.status === currentStatus
        );
        if (currentStepIndex === -1) currentStepIndex = 0;

        // Create step elements
        processSteps.forEach((step, index) => {
          const stepElement = document.createElement("div");
          stepElement.className = "step";

          if (index < currentStepIndex) {
            stepElement.classList.add("completed");
          } else if (index === currentStepIndex) {
            stepElement.classList.add("current");
          }

          stepElement.innerHTML = `
                    <div class="step-number">${index + 1}</div>
                    <div class="step-label">${step.label}</div>
                `;

          trackElement.appendChild(stepElement);
        });

        // Update progress line fill
        const progressFill = document.getElementById("progressFill");
        const progressPercentage =
          (currentStepIndex / (processSteps.length - 1)) * 100;
        progressFill.style.width = `${progressPercentage}%`;

        // Update current status text
        const currentStatusText = document.getElementById("currentStatusText");
        currentStatusText.textContent = `Current Step: ${processSteps[currentStepIndex].label}`;
      }

      // Function to update progress (can be called from parent form)
      window.updateProgress = function (newStatus) {
        renderProgress(newStatus);
      };
    </script>
  </body>
</html>
